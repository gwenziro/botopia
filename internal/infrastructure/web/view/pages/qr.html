<div x-data="connectivityApp" x-init="initialize()" class="p-connectivity">
    <div class="p-connectivity__content">
        <!-- Status heading -->
        <div class="p-connectivity-status">
            <h1 class="p-connectivity-status__title">
                <template x-if="connectionState === 'connected'">
                    Status: Terhubung
                </template>
                <template x-if="connectionState !== 'connected'">
                    Status: Tidak Terhubung
                </template>
            </h1>
            <p class="p-connectivity-status__subtitle">
                <template x-if="connectionState === 'connected'">
                    WhatsApp berhasil terhubung. Anda dapat menggunakan layanan bot sekarang.
                </template>
                <template x-if="connectionState !== 'connected'">
                    Pindai kode QR dengan WhatsApp di ponsel Anda untuk terhubung.
                </template>
            </p>
            
            <!-- Auto refresh badge untuk QR Code -->
            <template x-if="connectionState !== 'connected'">
                <div class="p-auto-refresh">
                    <i class="fas fa-sync-alt fa-spin"></i> Auto-refresh aktif
                </div>
            </template>
        </div>
        
        <!-- QR Code section - tampilkan hanya jika tidak terhubung -->
        <template x-if="connectionState !== 'connected' && qrCode">
            <div class="p-connectivity-qrbox">
                <img :src="getQRImageURL()" alt="WhatsApp QR Code" class="p-connectivity-qrbox__image">
            </div>
        </template>
        
        <!-- Loading state - tampilkan hanya jika tidak terhubung dan tidak ada QR -->
        <template x-if="connectionState !== 'connected' && !qrCode">
            <div class="p-connectivity-qrbox">
                <div class="p-connectivity-loading">
                    <div class="p-connectivity-loading__spinner"></div>
                    <p>Memuat kode QR...</p>
                </div>
            </div>
        </template>
        
        <!-- Connected state info -->
        <template x-if="connectionState === 'connected'">
            <!-- Connected info panel -->
            <div class="p-connected-info">
                <div class="p-connected-info__header">
                    <h2 class="p-connected-info__title">
                        <i class="fas fa-check-circle p-connected-info__icon"></i>
                        WhatsApp Terhubung
                    </h2>
                </div>
                
                <div class="p-connected-info__details">
                    <!-- Phone detail -->
                    <div class="p-connected-info__detail">
                        <div class="p-connected-info__detail-icon">
                            <i class="fas fa-phone"></i>
                        </div>
                        <div class="p-connected-info__detail-content">
                            <div class="p-connected-info__detail-label">Nomor Telepon</div>
                            <div class="p-connected-info__detail-value" x-text="formatPhone(phone)"></div>
                        </div>
                    </div>
                    
                    <!-- Name detail -->
                    <div class="p-connected-info__detail">
                        <div class="p-connected-info__detail-icon">
                            <i class="fas fa-user"></i>
                        </div>
                        <div class="p-connected-info__detail-content">
                            <div class="p-connected-info__detail-label">Nama</div>
                            <div class="p-connected-info__detail-value" x-text="name"></div>
                        </div>
                    </div>
                    
                    <!-- Uptime detail -->
                    <div class="p-connected-info__detail">
                        <div class="p-connected-info__detail-icon">
                            <i class="fas fa-clock"></i>
                        </div>
                        <div class="p-connected-info__detail-content">
                            <div class="p-connected-info__detail-label">Waktu Aktif</div>
                            <div class="p-connected-info__detail-value" x-text="formatUptime(uptime)"></div>
                        </div>
                    </div>
                    
                    <!-- Connected Since detail -->
                    <div class="p-connected-info__detail">
                        <div class="p-connected-info__detail-icon">
                            <i class="fas fa-calendar-check"></i>
                        </div>
                        <div class="p-connected-info__detail-content">
                            <div class="p-connected-info__detail-label">Terhubung Sejak</div>
                            <div class="p-connected-info__detail-value" x-text="formatDate(connectedSince)"></div>
                        </div>
                    </div>
                </div>
                
                <!-- Disconnect button -->
                <div class="u-text-center u-mt-4">
                    <button @click="disconnect()" class="p-disconnect-btn">
                        <i class="fas fa-plug-circle-xmark"></i> Putuskan Koneksi
                    </button>
                </div>
            </div>
            
            <!-- Device Details Section - tampilkan hanya jika ada deviceDetails -->
            <template x-if="deviceDetails">
                <div class="p-device-info">
                    <h3 class="p-device-info__title">
                        <i class="fas fa-mobile-alt p-device-info__icon"></i>
                        Informasi Perangkat
                    </h3>
                    
                    <div class="p-device-info__grid">
                        <!-- Platform -->
                        <template x-if="deviceDetails.platform">
                            <div class="p-device-info__item">
                                <div class="p-device-info__item-label">Platform</div>
                                <div class="p-device-info__item-value" x-text="deviceDetails.platform"></div>
                            </div>
                        </template>
                        
                        <!-- Device Model -->
                        <template x-if="deviceDetails.deviceModel">
                            <div class="p-device-info__item">
                                <div class="p-device-info__item-label">Model Perangkat</div>
                                <div class="p-device-info__item-value" x-text="deviceDetails.deviceModel"></div>
                            </div>
                        </template>
                        
                        <!-- OS Version -->
                        <template x-if="deviceDetails.osVersion">
                            <div class="p-device-info__item">
                                <div class="p-device-info__item-label">Versi OS</div>
                                <div class="p-device-info__item-value" x-text="deviceDetails.osVersion"></div>
                            </div>
                        </template>
                        
                        <!-- Device ID -->
                        <template x-if="deviceDetails.deviceId">
                            <div class="p-device-info__item">
                                <div class="p-device-info__item-label">ID Perangkat</div>
                                <div class="p-device-info__item-value" x-text="deviceDetails.deviceId"></div>
                            </div>
                        </template>
                    </div>
                </div>
            </template>
        </template>
        
        <!-- Instructions - tampilkan hanya jika tidak terhubung -->
        <template x-if="connectionState !== 'connected'">
            <div class="p-connectivity-instructions">
                <h3 class="p-connectivity-instructions__title">
                    <i class="fas fa-info-circle"></i> Cara Menghubungkan WhatsApp
                </h3>
                
                <ol class="p-connectivity-instructions__list">
                    <li class="p-connectivity-instructions__step">
                        <div class="p-connectivity-instructions__step-title">Buka WhatsApp di ponsel Anda</div>
                        <div class="p-connectivity-instructions__step-desc">
                            Pastikan WhatsApp sudah terinstal dan aktif di ponsel Anda.
                        </div>
                    </li>
                    <li class="p-connectivity-instructions__step">
                        <div class="p-connectivity-instructions__step-title">Buka Menu Pengaturan</div>
                        <div class="p-connectivity-instructions__step-desc">
                            Ketuk ikon titik tiga di pojok kanan atas, lalu pilih "WhatsApp Web".
                        </div>
                    </li>
                    <li class="p-connectivity-instructions__step">
                        <div class="p-connectivity-instructions__step-title">Pindai Kode QR</div>
                        <div class="p-connectivity-instructions__step-desc">
                            Arahkan kamera ponsel Anda ke kode QR yang ditampilkan di halaman ini.
                        </div>
                    </li>
                    <li class="p-connectivity-instructions__step">
                        <div class="p-connectivity-instructions__step-title">Tunggu Proses Koneksi</div>
                        <div class="p-connectivity-instructions__step-desc">
                            Setelah kode QR dipindai, tunggu hingga proses koneksi selesai. 
                            Halaman akan otomatis beralih ke status terhubung.
                        </div>
                    </li>
                </ol>
            </div>
        </template>
    </div>
</div>