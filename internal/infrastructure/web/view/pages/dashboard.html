<div x-data="dashboardApp" x-init="initialize()" class="u-space-y-6 p-dashboard">

    <!-- Statistics Card -->
    <div class="c-card">
        <div class="c-card__body">
            <h2 class="c-card__title u-flex u-items-center u-gap-2 u-mb-4">
                <i class="fas fa-chart-simple u-text-primary-400"></i>
                Statistik Dasar
            </h2>

            <div class="c-stats-grid">
                <!-- Message Count Stats -->
                <div class="c-stats-card c-stats-card--info">
                    <div class="c-stats-card__icon">
                        <i class="fas fa-envelope"></i>
                    </div>
                    <div class="c-stats-card__content">
                        <h3 class="c-stats-card__title">Total Pesan Masuk</h3>
                        <p class="c-stats-card__value" x-text="formatNumber(stats.messageCount)"></p>
                    </div>
                </div>

                <!-- Commands Run Stats -->
                <div class="c-stats-card c-stats-card--info">
                    <div class="c-stats-card__icon">
                        <i class="fas fa-terminal"></i>
                    </div>
                    <div class="c-stats-card__content">
                        <h3 class="c-stats-card__title">Command Dijalankan</h3>
                        <p class="c-stats-card__value" x-text="formatNumber(stats.commandsRun)"></p>
                    </div>
                </div>

                <!-- Commands Available Stats - Updated with commands color class -->
                <div class="c-stats-card c-stats-card--info">
                    <div class="c-stats-card__icon">
                        <i class="fas fa-code"></i>
                    </div>
                    <div class="c-stats-card__content">
                        <h3 class="c-stats-card__title">Command Tersedia</h3>
                        <p class="c-stats-card__value" x-text="formatNumber(stats.commandCount)"></p>
                    </div>
                </div>

                <!-- System Uptime Stats -->
                <div class="c-stats-card c-stats-card--info">
                    <div class="c-stats-card__icon">
                        <i class="fas fa-clock"></i>
                    </div>
                    <div class="c-stats-card__content">
                        <h3 class="c-stats-card__title">Waktu Aktif Sistem</h3>
                        <p class="c-stats-card__value" x-text="formatUptimeDuration(stats.systemUptime)"></p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Info Sections Container - Side by Side -->
    <div class="p-dashboard-info-container">
        <!-- WhatsApp Account Info Card -->
        <div class="p-dashboard-info-card c-card h-full">
            <div class="c-card__body">
                <h2 class="c-card__title u-flex u-items-center u-gap-2 u-mb-4">
                    <i class="fab fa-whatsapp u-text-primary-400"></i>
                    Informasi Akun WhatsApp
                </h2>

                <div class="p-connection-status">
                    <div class="p-connection-status__content">
                        <template x-if="isConnected">
                            <div class="p-connection-info">
                                <div class="p-connection-info__grid">
                                    <!-- User Info Item -->
                                    <div class="c-info-item">
                                        <div class="c-info-item__icon">
                                            <i class="fas fa-user u-text-primary-400"></i>
                                        </div>
                                        <div class="c-info-item__content">
                                            <div class="c-info-item__label">Nama Akun</div>
                                            <div class="c-info-item__value"
                                                x-text="name !== 'WhatsApp User' ? name : (phone || 'WhatsApp User')">
                                            </div>
                                        </div>
                                    </div>

                                    <!-- Phone Number Item -->
                                    <div class="c-info-item">
                                        <div class="c-info-item__icon">
                                            <i class="fas fa-phone u-text-primary-400"></i>
                                        </div>
                                        <div class="c-info-item__content">
                                            <div class="c-info-item__label">Nomor Telepon</div>
                                            <div class="c-info-item__value" x-text="formatPhone(phone) || '-'"></div>
                                        </div>
                                    </div>

                                    <!-- Connected Since Item -->
                                    <div class="c-info-item">
                                        <div class="c-info-item__icon">
                                            <i class="fas fa-calendar-check u-text-primary-400"></i>
                                        </div>
                                        <div class="c-info-item__content">
                                            <div class="c-info-item__label">Terhubung Sejak</div>
                                            <div class="c-info-item__value" x-text="formatDate(connectedSince)"></div>
                                        </div>
                                    </div>

                                    <!-- Device ID Item -->
                                    <div class="c-info-item">
                                        <div class="c-info-item__icon">
                                            <i class="fas fa-fingerprint u-text-primary-400"></i>
                                        </div>
                                        <div class="c-info-item__content">
                                            <div class="c-info-item__label">ID Perangkat</div>
                                            <div class="c-info-item__value" x-text="deviceDetails?.deviceId || '-'">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </template>

                        <!-- Disconnected Info -->
                        <div class="p-connection-not-connected" x-show="!isConnected">
                            <div class="p-connection-not-connected__icon">
                                <i class="fas fa-plug-circle-xmark"></i>
                            </div>
                            <div class="p-connection-not-connected__message">
                                Tidak terhubung ke WhatsApp
                            </div>
                            <div class="p-connection-not-connected__action">
                                <a href="/connectivity" class="c-btn c-btn--primary u-flex u-items-center u-gap-2">
                                    <i class="fas fa-qrcode"></i> Scan QR Code
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Google Service Info Card - Updated layout -->
        <div class="p-dashboard-info-card c-card">
            <div class="c-card__body">
                <h2 class="c-card__title u-flex u-items-center u-gap-2 u-mb-4">
                    <i class="fab fa-google u-text-primary-400"></i>
                    Informasi Layanan Google
                </h2>

                <div class="p-google-services">
                    <div class="p-google-services__content">
                        <template x-if="googleServices.isConfigured">
                            <div class="p-google-info">
                                <!-- Google Sheets Item -->
                                <div class="c-service-item">
                                    <div class="c-service-item__header">
                                        <div class="c-service-item__header-left">
                                            <div class="c-service-item__icon">
                                                <i class="fas fa-table u-text-primary-400"></i>
                                            </div>
                                            <div class="c-service-item__title-container">
                                                <h3 class="c-service-item__title">
                                                    Google Sheets
                                                    <span x-show="googleServices.sheets.isConnected"
                                                        class="c-service-item__status c-service-item__status--active">
                                                        <i class="fas fa-check-circle"></i>
                                                    </span>
                                                    <span x-show="!googleServices.sheets.isConnected"
                                                        class="c-service-item__status c-service-item__status--inactive">
                                                        <i class="fas fa-times-circle"></i>
                                                    </span>
                                                </h3>
                                                <div class="c-service-item__id" x-show="googleServices.sheets.id"
                                                    x-text="googleServices.sheets.id"></div>
                                            </div>
                                        </div>
                                        <div class="c-service-item__action"
                                            x-show="googleServices.sheets.isConnected && googleServices.sheets.url && googleServices.sheets.url !== '#'">
                                            <a :href="googleServices.sheets.url" target="_blank"
                                                class="c-btn c-btn--sm c-btn--primary">
                                                <i class="fas fa-external-link-alt"></i> Buka
                                            </a>
                                        </div>
                                    </div>
                                </div>

                                <!-- Google Drive Item -->
                                <div class="c-service-item">
                                    <div class="c-service-item__header">
                                        <div class="c-service-item__header-left">
                                            <div class="c-service-item__icon">
                                                <i class="fab fa-google-drive u-text-primary-400"></i>
                                            </div>
                                            <div class="c-service-item__title-container">
                                                <h3 class="c-service-item__title">
                                                    Google Drive
                                                    <span x-show="googleServices.drive.isConnected"
                                                        class="c-service-item__status c-service-item__status--active">
                                                        <i class="fas fa-check-circle"></i>
                                                    </span>
                                                    <span x-show="!googleServices.drive.isConnected"
                                                        class="c-service-item__status c-service-item__status--inactive">
                                                        <i class="fas fa-times-circle"></i>
                                                    </span>
                                                </h3>
                                                <div class="c-service-item__id" x-show="googleServices.drive.id"
                                                    x-text="googleServices.drive.id"></div>
                                            </div>
                                        </div>
                                        <div class="c-service-item__action"
                                            x-show="googleServices.drive.isConnected && googleServices.drive.url && googleServices.drive.url !== '#'">
                                            <a :href="googleServices.drive.url" target="_blank"
                                                class="c-btn c-btn--sm c-btn--primary">
                                                <i class="fas fa-external-link-alt"></i> Buka
                                            </a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </template>

                        <!-- Not Configured Info -->
                        <div class="p-google-not-configured" x-show="!googleServices.isConfigured">
                            <div class="p-google-not-configured__icon">
                                <i class="fas fa-exclamation-triangle"></i>
                            </div>
                            <div class="p-google-not-configured__message">
                                Layanan Google belum dikonfigurasi
                            </div>
                            <div class="p-google-not-configured__action">
                                <a href="/konfigurasi" class="c-btn c-btn--primary u-flex u-items-center u-gap-2">
                                    <i class="fas fa-cog"></i> Konfigurasi
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Commands List Section - RESTORED -->
    <div class="c-card">
        <div class="c-card__body">
            <div class="u-flex u-items-center u-justify-between u-mb-4">
                <h2 class="c-card__title u-flex u-items-center u-gap-2 u-mb-0">
                    <i class="fas fa-terminal u-text-primary-400"></i>
                    Command Tersedia
                </h2>
                <a href="/commands" class="p-view-all">
                    <span>Lihat Semua</span>
                    <i class="fas fa-arrow-right"></i>
                </a>
            </div>

            <!-- Command List with Dynamic Icons -->
            <div class="p-commands-list" x-show="Object.keys(commands).length > 0">
                <template x-for="(command, name) in commands" :key="name">
                    <div class="p-command-item">
                        <div class="p-command-icon">
                            <i class="fas" :class="getCommandIcon(name)"></i>
                        </div>
                        <div class="p-command-content">
                            <h3 class="p-command-name" x-text="'!' + name"></h3>
                            <p class="p-command-description" x-text="command.description"></p>
                        </div>
                    </div>
                </template>
            </div>

            <div class="p-commands-empty" x-show="Object.keys(commands).length === 0">
                <div class="p-commands-empty__icon">
                    <i class="fas fa-code"></i>
                </div>
                <h3 class="p-commands-empty__title">Belum ada command</h3>
                <p class="p-commands-empty__text">Belum ada command yang tersedia saat ini.</p>
            </div>
        </div>
    </div>

    <!-- System Info -->
    <div class="u-flex u-justify-between u-text-sm u-text-slate-500 u-px-2">
        <div>Botopia v1.0.0</div>
        <div>Waktu Server: <span x-text="new Date().toLocaleString()"></span></div>
    </div>
</div>